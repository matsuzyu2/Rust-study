# Chapter 10: Solana/Anchor

> **ã“ã®ç« ã§å­¦ã¶ã“ã¨**: Solanaã®æ¦‚è¦ã€Anchorãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã€Programé–‹ç™ºã®åŸºç¤ â€” Rustã§ã®Web3é–‹ç™º

> ğŸ“– **è¨˜å·ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹**: ã“ã®ç« ã§ã¯ `<'info>`, `#[account]`, `#[program]` ãªã©ç‹¬ç‰¹ã®æ§‹æ–‡ãŒç™»å ´ã—ã¾ã™ã€‚Rustæ§‹æ–‡ã®å¾©ç¿’ã«ã¯ [Chapter 11: è¨˜å·ãƒ»æ§‹æ–‡ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹](11-syntax-reference.md) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

---

## ãªãœRust Ã— Solanaï¼Ÿ

| ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ | ä¸»è¦è¨€èª | ç‰¹å¾´ |
|----------------|---------|------|
| Ethereum | Solidity | æœ€å¤§ã®ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ã€EVM |
| Solana | **Rust** | é«˜é€Ÿï¼ˆ65,000+ TPSï¼‰ã€ä½æ‰‹æ•°æ–™ |
| Polkadot | **Rust** | ã‚¯ãƒ­ã‚¹ãƒã‚§ãƒ¼ãƒ³ã€Substrate |
| Near | **Rust** | ã‚·ãƒ£ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° |
| Cosmos | Go, Rust | IBC |

**Solanaã‚’é¸ã¶ç†ç”±**:
1. **é«˜é€Ÿãƒ»ä½ã‚³ã‚¹ãƒˆ**: ç§’é–“65,000ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã€æ‰‹æ•°æ–™ ~$0.00025
2. **Rustãƒã‚¤ãƒ†ã‚£ãƒ–**: Rustã®å®‰å…¨æ€§ãŒã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã«è²¢çŒ®
3. **æˆé•·ã™ã‚‹ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ **: DeFiã€NFTã€ã‚²ãƒ¼ãƒ ã§æ´»ç™º

---

## Solanaã®åŸºæœ¬æ¦‚å¿µ

### ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ¢ãƒ‡ãƒ«

Solanaã¯**ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ¢ãƒ‡ãƒ«**ã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ï¼ˆEthereumã‚‚åŒæ§˜ï¼‰ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Account                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ lamports: u64        // æ®‹é«˜ï¼ˆSOLã®æœ€å°å˜ä½ï¼‰          â”‚
â”‚ data: Vec<u8>        // ä»»æ„ã®ãƒ‡ãƒ¼ã‚¿                  â”‚
â”‚ owner: Pubkey        // ã“ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’æ‰€æœ‰ã™ã‚‹Program â”‚
â”‚ executable: bool     // Programã‹ã©ã†ã‹              â”‚
â”‚ rent_epoch: u64      // ãƒ¬ãƒ³ãƒˆæ”¯æ‰•ã„                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãªãœã€Œã‚¢ã‚«ã‚¦ãƒ³ãƒˆã€ã¨ã„ã†æ¦‚å¿µãŒå¿…è¦ãªã®ã‹

ğŸ”„ **æ¯”è¼ƒï¼ˆå¾“æ¥ã®Webé–‹ç™ºï¼‰**:
```
å¾“æ¥ã®Webã‚¢ãƒ—ãƒª:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ã‚µãƒ¼ãƒãƒ¼   â”‚â”€â”€â”€â”€â†’â”‚  ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ â”‚
â”‚  (Node.js)  â”‚     â”‚  (PostgreSQL)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ã‚µãƒ¼ãƒãƒ¼ãŒDBã¸ã®èª­ã¿æ›¸ãã‚’åˆ¶å¾¡

Solana:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Program   â”‚â”€â”€â”€â”€â†’â”‚   Account   â”‚
â”‚  (Rust)     â”‚     â”‚   (çŠ¶æ…‹)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ProgramãŒã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›´
â€» èª°ã§ã‚‚ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ã€Œèª­ã‚ã‚‹ã€ãŒã€ã€Œæ›¸ã‘ã‚‹ã€ã®ã¯æ‰€æœ‰è€…ã®ã¿
```

### Programï¼ˆã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆï¼‰

Solanaã§ã¯ã€Œã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã€ã‚’**Program**ã¨å‘¼ã³ã¾ã™ã€‚

**é‡è¦ãªç‰¹å¾´**:
- **ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¬ã‚¹**: Programè‡ªä½“ã¯ãƒ‡ãƒ¼ã‚¿ã‚’æŒãŸãªã„
- **ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜**: ãƒ‡ãƒ¼ã‚¿ã¯åˆ¥ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«æ ¼ç´
- **ä¸¦åˆ—å®Ÿè¡Œå¯èƒ½**: ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒç•°ãªã‚Œã°ä¸¦åˆ—å®Ÿè¡Œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ethereumã¨Solanaã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¯”è¼ƒ                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Ethereum:                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚ Contract                            â”‚                       â”‚
â”‚  â”‚  â”œâ”€ ã‚³ãƒ¼ãƒ‰ï¼ˆãƒã‚¤ãƒˆã‚³ãƒ¼ãƒ‰ï¼‰            â”‚  â† ä¸€ä½“åŒ–             â”‚
â”‚  â”‚  â””â”€ ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ï¼ˆçŠ¶æ…‹å¤‰æ•°ï¼‰            â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                                                 â”‚
â”‚  Solana:                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚ Program         â”‚     â”‚ Account A        â”‚                   â”‚
â”‚  â”‚  â””â”€ ã‚³ãƒ¼ãƒ‰ã®ã¿   â”‚â”€â”€â”€â”€â†’â”‚  â””â”€ ãƒ‡ãƒ¼ã‚¿       â”‚  â† åˆ†é›¢            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚           â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚ Account B        â”‚                   â”‚
â”‚                          â”‚  â””â”€ ãƒ‡ãƒ¼ã‚¿       â”‚                   â”‚
â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                 â”‚
â”‚  Solanaã®åˆ©ç‚¹:                                                  â”‚
â”‚  - è¤‡æ•°ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä¸¦åˆ—ã«å‡¦ç†å¯èƒ½                               â”‚
â”‚  - ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®æŸ”è»Ÿæ€§ãŒé«˜ã„                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## é–‹ç™ºç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### å¿…è¦ãªãƒ„ãƒ¼ãƒ«

```bash
# Rustï¼ˆæ—¢ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ã¨ä»®å®šï¼‰
rustup update

# Solana CLI
sh -c "$(curl -sSfL https://release.solana.com/stable/install)"

# Anchor CLI
cargo install --git https://github.com/coral-xyz/anchor anchor-cli --locked

# ç¢ºèª
solana --version
anchor --version
```

### ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã®è¨­å®š

```bash
# ãƒ­ãƒ¼ã‚«ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«è¨­å®š
solana config set --url localhost

# æ–°ã—ã„ã‚­ãƒ¼ãƒšã‚¢ã‚’ä½œæˆï¼ˆã‚¦ã‚©ãƒ¬ãƒƒãƒˆï¼‰
solana-keygen new

# ãƒ­ãƒ¼ã‚«ãƒ«ãƒãƒªãƒ‡ãƒ¼ã‚¿ã‚’èµ·å‹•ï¼ˆåˆ¥ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§å®Ÿè¡Œï¼‰
solana-test-validator
```

---

## Anchorã¨ã¯

**Anchor**ã¯Solana Programé–‹ç™ºã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã™ã€‚ç´ ã®Solanaé–‹ç™ºã¨æ¯”è¼ƒã™ã‚‹ã¨ï¼š

| æ©Ÿèƒ½ | ç´ ã®Solana | Anchor |
|-----|-----------|--------|
| ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ¤œè¨¼ | æ‰‹å‹•ã§å…¨ãƒã‚§ãƒƒã‚¯ | ãƒã‚¯ãƒ­ã§è‡ªå‹•ç”Ÿæˆ |
| ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º | Borshæ‰‹å‹•å®Ÿè£… | è‡ªå‹• |
| ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° | ç”Ÿã®ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ | æ§‹é€ åŒ–ã‚¨ãƒ©ãƒ¼ |
| ãƒ†ã‚¹ãƒˆ | è¤‡é›‘ | TypeScriptçµ±åˆ |
| ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ | æ‰‹å‹•ç”Ÿæˆ | IDLè‡ªå‹•ç”Ÿæˆ |

### Anchorã‚’ä½¿ã†ç†ç”±

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç´ ã®Solanaé–‹ç™º vs Anchor                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  ç´ ã®Solanaï¼ˆç´„100è¡Œã®ãƒœã‚¤ãƒ©ãƒ¼ãƒ—ãƒ¬ãƒ¼ãƒˆï¼‰:                         â”‚
â”‚  - ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®æ‰€æœ‰è€…æ¤œè¨¼ã‚’æ‰‹å‹•ã§å®Ÿè£…                              â”‚
â”‚  - Borshã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º/ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã‚’æ‰‹å‹•ã§å®Ÿè£…                    â”‚
â”‚  - ç½²åè€…æ¤œè¨¼ã‚’æ‰‹å‹•ã§å®Ÿè£…                                         â”‚
â”‚  - discriminatorã‚’æ‰‹å‹•ã§ç®¡ç†                                     â”‚
â”‚                                                                 â”‚
â”‚  Anchorï¼ˆãƒã‚¯ãƒ­ã§è‡ªå‹•ç”Ÿæˆï¼‰:                                      â”‚
â”‚  - #[account] â†’ æ‰€æœ‰è€…æ¤œè¨¼ + ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º                         â”‚
â”‚  - #[derive(Accounts)] â†’ å¿…è¦ãªã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ¤œè¨¼                     â”‚
â”‚  - Signer<'info> â†’ ç½²åè€…æ¤œè¨¼                                    â”‚
â”‚  - 8ãƒã‚¤ãƒˆã®discriminatorã‚’è‡ªå‹•ç®¡ç†                               â”‚
â”‚                                                                 â”‚
â”‚  çµæœ: åŒã˜æ©Ÿèƒ½ã‚’1/3ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã§å®‰å…¨ã«å®Ÿè£…ã§ãã‚‹                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æœ€åˆã®Program

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ

```bash
anchor init my_program
cd my_program
```

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
my_program/
â”œâ”€â”€ Anchor.toml         # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®š
â”œâ”€â”€ Cargo.toml
â”œâ”€â”€ programs/
â”‚   â””â”€â”€ my_program/
â”‚       â”œâ”€â”€ Cargo.toml
â”‚       â””â”€â”€ src/
â”‚           â””â”€â”€ lib.rs  # â† Programã®ã‚³ãƒ¼ãƒ‰ï¼ˆã“ã“ã‚’ç·¨é›†ï¼‰
â”œâ”€â”€ tests/
â”‚   â””â”€â”€ my_program.ts   # TypeScriptãƒ†ã‚¹ãƒˆ
â””â”€â”€ migrations/
    â””â”€â”€ deploy.ts
```

### Hello Worldãƒ—ãƒ­ã‚°ãƒ©ãƒ 

**programs/my_program/src/lib.rs**:
```rust
use anchor_lang::prelude::*;

declare_id!("Fg6PaFpoGXkYsidMpWTK6W2BeZ7FEfcYkg476zPFsLnS");

#[program]
pub mod my_program {
    use super::*;

    pub fn initialize(ctx: Context<Initialize>) -> Result<()> {
        msg!("Hello, Solana!");
        Ok(())
    }
}

#[derive(Accounts)]
pub struct Initialize {}
```

### å„è¡Œã‚’èª­ã¿è§£ã â€” Anchorã®åŸºæœ¬æ§‹é€ 

```rust
use anchor_lang::prelude::*;
```
- Anchorã®åŸºæœ¬çš„ãªå‹ã‚„ãƒã‚¯ãƒ­ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
- `Context`, `Result`, `Account`, `Signer`ãªã©ãŒå«ã¾ã‚Œã‚‹

```rust
declare_id!("Fg6PaFpoGXkYsidMpWTK6W2BeZ7FEfcYkg476zPFsLnS");
```
- **Programã®IDï¼ˆã‚¢ãƒ‰ãƒ¬ã‚¹ï¼‰ã‚’å®£è¨€**
- `anchor build`æ™‚ã«è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹
- ã“ã®IDã§ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ä¸Šã®Programã‚’ä¸€æ„ã«è­˜åˆ¥

```rust
#[program]
pub mod my_program {
```
- `#[program]`å±æ€§ = ã€Œã“ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯Solana Programã§ã™ã€
- AnchorãŒã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã‚’è‡ªå‹•ç”Ÿæˆ
- ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å`my_program`ãŒProgramåã«ãªã‚‹

```rust
    pub fn initialize(ctx: Context<Initialize>) -> Result<()> {
```
- **å‘½ä»¤ï¼ˆInstructionï¼‰ã®å®šç¾©**
- `ctx: Context<Initialize>` = ã“ã®å‘½ä»¤ã«å¿…è¦ãªã‚¢ã‚«ã‚¦ãƒ³ãƒˆç¾¤
- `-> Result<()>` = æˆåŠŸ/å¤±æ•—ã‚’è¿”ã™ï¼ˆAnchorã®`Result`å‹ï¼‰

```rust
        msg!("Hello, Solana!");
```
- **ãƒ­ã‚°å‡ºåŠ›ãƒã‚¯ãƒ­**
- `println!`ã®ä»£ã‚ã‚Šï¼ˆSolanaãƒ©ãƒ³ã‚¿ã‚¤ãƒ ç”¨ï¼‰
- ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ­ã‚°ã«è¡¨ç¤ºã•ã‚Œã‚‹

```rust
#[derive(Accounts)]
pub struct Initialize {}
```
- **å¿…è¦ãªã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’å®šç¾©ã™ã‚‹æ§‹é€ ä½“**
- `#[derive(Accounts)]` = AnchorãŒã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ¤œè¨¼ã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆ
- ä»Šå›ã¯ç©ºï¼ˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆä¸è¦ï¼‰

---

## `<'info>`ãƒ©ã‚¤ãƒ•ã‚¿ã‚¤ãƒ ã®è¬ã‚’è§£ã

Anchorç‰¹æœ‰ã®`<'info>`ã‚’è¦‹ã¦ã€Œã“ã‚Œã¯ä½•ï¼Ÿã€ã¨æ€ã£ãŸæ–¹ã‚‚å¤šã„ã§ã—ã‚‡ã†ã€‚

```rust
#[derive(Accounts)]
pub struct Initialize<'info> {
    #[account(mut)]
    pub user: Signer<'info>,
    pub system_program: Program<'info, System>,
}
```

### `'info`ã¨ã¯ä½•ã‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  'info ãƒ©ã‚¤ãƒ•ã‚¿ã‚¤ãƒ ã®æ„å‘³                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å‡¦ç†ã®æµã‚Œ:                                     â”‚
â”‚                                                                 â”‚
â”‚  1. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’é€ä¿¡                          â”‚
â”‚     â””â”€ ã€Œã“ã‚Œã‚‰ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½¿ã£ã¦ã€ã“ã®å‘½ä»¤ã‚’å®Ÿè¡Œã—ã¦ã€          â”‚
â”‚                                                                 â”‚
â”‚  2. Solanaãƒ©ãƒ³ã‚¿ã‚¤ãƒ ãŒã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ã‚’ãƒ­ãƒ¼ãƒ‰                      â”‚
â”‚     â””â”€ AccountInfoæ§‹é€ ä½“ã®é…åˆ—ã‚’ç”¨æ„                             â”‚
â”‚     â””â”€ ã“ã®é…åˆ—ãŒã€Œ'infoã€ã®æœŸé–“ã ã‘æœ‰åŠ¹                          â”‚
â”‚                                                                 â”‚
â”‚  3. ProgramãŒå®Ÿè¡Œã•ã‚Œã‚‹                                          â”‚
â”‚     â””â”€ AccountInfo ã¸ã®å‚ç…§ã‚’ä½¿ã£ã¦ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿æ›¸ã                â”‚
â”‚                                                                 â”‚
â”‚  4. ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å®Œäº†                                          â”‚
â”‚     â””â”€ AccountInfoé…åˆ—ãŒè§£æ”¾ã•ã‚Œã‚‹                                â”‚
â”‚     â””â”€ 'infoãƒ©ã‚¤ãƒ•ã‚¿ã‚¤ãƒ çµ‚äº†                                      â”‚
â”‚                                                                 â”‚
â”‚  'info = ã€Œ1å›ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å‡¦ç†ä¸­ã€ã¨ã„ã†æœŸé–“ã‚’è¡¨ã™           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãªãœ`'info`ãŒå¿…è¦ãªã®ã‹

```rust
// Anchorã®å†…éƒ¨å‹ï¼ˆç°¡ç•¥åŒ–ï¼‰
pub struct Account<'info, T> {
    // AccountInfoã¸ã®å‚ç…§ã‚’ä¿æŒ
    info: &'info AccountInfo<'info>,
    // ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿
    account: T,
}

pub struct Signer<'info> {
    info: &'info AccountInfo<'info>,
}
```

**ãƒã‚¤ãƒ³ãƒˆ**:
- `Account<'info, T>`ã¯**AccountInfoã¸ã®å‚ç…§**ã‚’æŒã¤
- ã“ã®å‚ç…§ã¯**ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å‡¦ç†ä¸­ã®ã¿æœ‰åŠ¹**
- `'info`ã¯ãã®ã€Œæœ‰åŠ¹æœŸé–“ã€ã‚’è¡¨ã™ãƒ©ã‚¤ãƒ•ã‚¿ã‚¤ãƒ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

### Chapter 02ã®çŸ¥è­˜ã¨ã®æ¥ç¶š

```
Chapter 02ã§å­¦ã‚“ã ã“ã¨:
- å‚ç…§ï¼ˆ&Tï¼‰ã«ã¯æœ‰åŠ¹æœŸé–“ãŒã‚ã‚‹
- ãƒ©ã‚¤ãƒ•ã‚¿ã‚¤ãƒ ('a)ã§æœ‰åŠ¹æœŸé–“ã‚’æ˜ç¤ºã™ã‚‹

Anchorã§ã®å¿œç”¨:
- AccountInfoé…åˆ—ã®æœ‰åŠ¹æœŸé–“ = 'info
- Account<'info, T>ã¯'infoã®é–“ã ã‘æœ‰åŠ¹ãªå‚ç…§ã‚’æŒã¤
- ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãŒã€Œãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å¤–ã§ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½¿ã†ã€ãƒŸã‚¹ã‚’é˜²ã
```

---

## ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®å®šç¾© â€” Counterãƒ—ãƒ­ã‚°ãƒ©ãƒ 

å®Ÿç”¨çš„ãªä¾‹ã¨ã—ã¦ã€ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã‚’å®Ÿè£…ã—ã¾ã—ã‚‡ã†ã€‚

```rust
use anchor_lang::prelude::*;

declare_id!("...");

#[program]
pub mod counter {
    use super::*;

    pub fn initialize(ctx: Context<Initialize>) -> Result<()> {
        let counter = &mut ctx.accounts.counter;
        counter.count = 0;
        counter.authority = ctx.accounts.authority.key();
        Ok(())
    }

    pub fn increment(ctx: Context<Increment>) -> Result<()> {
        let counter = &mut ctx.accounts.counter;
        counter.count += 1;
        Ok(())
    }
}

#[account]
pub struct Counter {
    pub count: u64,
    pub authority: Pubkey,
}

#[derive(Accounts)]
pub struct Initialize<'info> {
    #[account(
        init,
        payer = authority,
        space = 8 + 8 + 32
    )]
    pub counter: Account<'info, Counter>,
    
    #[account(mut)]
    pub authority: Signer<'info>,
    
    pub system_program: Program<'info, System>,
}

#[derive(Accounts)]
pub struct Increment<'info> {
    #[account(
        mut,
        has_one = authority
    )]
    pub counter: Account<'info, Counter>,
    
    pub authority: Signer<'info>,
}
```

### å„éƒ¨åˆ†ã‚’è©³ã—ãè§£èª¬

#### `#[account]`å±æ€§ â€” ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®å®šç¾©

```rust
#[account]
pub struct Counter {
    pub count: u64,      // 8ãƒã‚¤ãƒˆ
    pub authority: Pubkey, // 32ãƒã‚¤ãƒˆ
}
```

**`#[account]`ãŒç”Ÿæˆã™ã‚‹ã‚‚ã®**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  #[account] ãƒã‚¯ãƒ­ã®å±•é–‹çµæœ                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  1. Borshã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º/ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã®å®Ÿè£…                       â”‚
â”‚     â†’ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿(Vec<u8>)ã¨æ§‹é€ ä½“ã®ç›¸äº’å¤‰æ›                 â”‚
â”‚                                                                 â”‚
â”‚  2. æ‰€æœ‰è€…ãƒã‚§ãƒƒã‚¯ã®å®Ÿè£…                                         â”‚
â”‚     â†’ ã“ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®æ‰€æœ‰è€…ãŒã“ã®Programã§ã‚ã‚‹ã“ã¨ã‚’æ¤œè¨¼          â”‚
â”‚                                                                 â”‚
â”‚  3. Discriminatorï¼ˆè­˜åˆ¥å­ï¼‰ã®ä»˜ä¸                                â”‚
â”‚     â†’ 8ãƒã‚¤ãƒˆã®ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªIDã§ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç¨®åˆ¥ã‚’è­˜åˆ¥                  â”‚
â”‚                                                                 â”‚
â”‚  4. AccountSerialize / AccountDeserialize ãƒˆãƒ¬ã‚¤ãƒˆã®å®Ÿè£…         â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Discriminatorï¼ˆè­˜åˆ¥å­ï¼‰ã¨ã¯

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Discriminator ã®ä»•çµ„ã¿                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®dataé ˜åŸŸ:                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ 8 bytes    â”‚ 8 bytes â”‚ 32 bytes                 â”‚           â”‚
â”‚  â”‚discriminatorâ”‚ count   â”‚ authority                â”‚           â”‚
â”‚  â”‚ (è­˜åˆ¥å­)    â”‚ (u64)   â”‚ (Pubkey)                 â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                 â”‚
â”‚  discriminator = sha256("account:Counter")[0..8]                â”‚
â”‚  â†’ "Counter"æ§‹é€ ä½“å°‚ç”¨ã®8ãƒã‚¤ãƒˆID                                â”‚
â”‚                                                                 â”‚
â”‚  ãªãœå¿…è¦ï¼Ÿ                                                      â”‚
â”‚  - åŒã˜ProgramãŒè¤‡æ•°ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå‹ã‚’æŒã¤å ´åˆ                      â”‚
â”‚  - ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®data(ãƒã‚¤ãƒˆåˆ—)ã ã‘ã§ã¯åŒºåˆ¥ã§ããªã„                  â”‚
â”‚  - discriminatorã§ã€Œã“ã®ãƒ‡ãƒ¼ã‚¿ã¯Counterå‹ã ã€ã¨è­˜åˆ¥                â”‚
â”‚                                                                 â”‚
â”‚  AnchorãŒè‡ªå‹•ã§:                                                 â”‚
â”‚  - ä¿å­˜æ™‚: discriminatorã‚’å…ˆé ­ã«ä»˜ä¸                             â”‚
â”‚  - èª­è¾¼æ™‚: discriminatorã‚’æ¤œè¨¼ï¼ˆä¸ä¸€è‡´ãªã‚‰ã‚¨ãƒ©ãƒ¼ï¼‰                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### `space = 8 + 8 + 32`ã®è¨ˆç®—

```rust
#[account(
    init,
    payer = authority,
    space = 8 + 8 + 32  // ãªãœã“ã®æ•°å€¤ï¼Ÿ
)]
pub counter: Account<'info, Counter>,
```

```
spaceè¨ˆç®—ã®å†…è¨³:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  8   = discriminator (AnchorãŒè‡ªå‹•ä»˜ä¸)                          â”‚
â”‚  8   = count: u64 ã®ã‚µã‚¤ã‚º                                       â”‚
â”‚  32  = authority: Pubkey ã®ã‚µã‚¤ã‚º                                â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                             â”‚
â”‚  48  = åˆè¨ˆãƒã‚¤ãƒˆæ•°                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ã‚ˆãä½¿ã†ã‚µã‚¤ã‚º:
| å‹         | ã‚µã‚¤ã‚º (bytes) |
|-----------|---------------|
| bool      | 1             |
| u8 / i8   | 1             |
| u16 / i16 | 2             |
| u32 / i32 | 4             |
| u64 / i64 | 8             |
| u128/i128 | 16            |
| Pubkey    | 32            |
| String    | 4 + len       |  â† é•·ã•ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ + æ–‡å­—æ•°
| Vec<T>    | 4 + n * sizeof(T) |
```

#### `#[derive(Accounts)]`ã¨åˆ¶ç´„

```rust
#[derive(Accounts)]
pub struct Initialize<'info> {
    #[account(
        init,                    // æ–°è¦ä½œæˆ
        payer = authority,       // ä½œæˆè²»ç”¨ã®æ”¯æ‰•ã„è€…
        space = 8 + 8 + 32       // å¿…è¦ãªãƒã‚¤ãƒˆæ•°
    )]
    pub counter: Account<'info, Counter>,
    
    #[account(mut)]              // ã“ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¯å¤‰æ›´ã•ã‚Œã‚‹
    pub authority: Signer<'info>, // ç½²åãŒå¿…è¦
    
    pub system_program: Program<'info, System>, // ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ã‚°ãƒ©ãƒ 
}
```

**å„åˆ¶ç´„ãŒä½•ã‚’ã™ã‚‹ã‹**:

| åˆ¶ç´„ | æ„å‘³ | è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹æ¤œè¨¼ |
|-----|------|------------------|
| `init` | ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ–°è¦ä½œæˆ | ç©ºã§ã‚ã‚‹ã“ã¨ã€ãƒ¬ãƒ³ãƒˆæ–™é‡‘ã®è¨ˆç®— |
| `mut` | å¤‰æ›´å¯èƒ½ | ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å¾Œã«å¤‰æ›´ã‚’ä¿å­˜ |
| `payer = X` | ä½œæˆè²»ç”¨æ”¯æ‰•è€… | Xã‹ã‚‰å¿…è¦SOLã‚’å¼•ãè½ã¨ã— |
| `has_one = X` | ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æ¤œè¨¼ | account.X == X.key() |
| `seeds`, `bump` | PDAç”Ÿæˆ | æ­£ã—ã„ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã‚ã‚‹ã“ã¨ã‚’æ¤œè¨¼ |

### Anchorã‚¢ã‚«ã‚¦ãƒ³ãƒˆå‹ã®ç¨®é¡

```rust
// 1. Account<'info, T> â€” ãƒ‡ãƒ¼ã‚¿ã‚’æŒã¤ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ
pub counter: Account<'info, Counter>,

// 2. Signer<'info> â€” ç½²åè€…ï¼ˆãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã«ç½²åã—ãŸäººï¼‰
pub authority: Signer<'info>,

// 3. Program<'info, T> â€” ä»–ã®Program
pub system_program: Program<'info, System>,

// 4. SystemAccount<'info> â€” é€šå¸¸ã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆï¼ˆãƒ‡ãƒ¼ã‚¿ãªã—ï¼‰
pub user_wallet: SystemAccount<'info>,

// 5. UncheckedAccount<'info> â€” æ¤œè¨¼ãªã—ï¼ˆå±é™ºã€ä¸Šç´šè€…å‘ã‘ï¼‰
/// CHECK: This account is not checked
pub some_account: UncheckedAccount<'info>,
```

---

## å‘½ä»¤ã®å®Ÿè£…ã‚’èª­ã¿è§£ã

### initializeå‘½ä»¤

```rust
pub fn initialize(ctx: Context<Initialize>) -> Result<()> {
    let counter = &mut ctx.accounts.counter;
    counter.count = 0;
    counter.authority = ctx.accounts.authority.key();
    Ok(())
}
```

**è¡Œã”ã¨ã®è§£èª¬**:

```rust
pub fn initialize(ctx: Context<Initialize>) -> Result<()> {
```
- `Context<Initialize>` = Initializeæ§‹é€ ä½“ã§å®šç¾©ã—ãŸã‚¢ã‚«ã‚¦ãƒ³ãƒˆç¾¤ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹
- AnchorãŒ`ctx.accounts`ã«ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºæ¸ˆã¿ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’è¨­å®š

```rust
let counter = &mut ctx.accounts.counter;
```
- `&mut` = å¯å¤‰å€Ÿç”¨ï¼ˆChapter 02å‚ç…§ï¼‰
- counterã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›´ã™ã‚‹ãŸã‚

```rust
counter.count = 0;
counter.authority = ctx.accounts.authority.key();
```
- æ§‹é€ ä½“ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å€¤ã‚’è¨­å®š
- `.key()` = ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®å…¬é–‹éµï¼ˆPubkeyï¼‰ã‚’å–å¾—

```rust
Ok(())
```
- æˆåŠŸã‚’è¿”ã™
- AnchorãŒå¤‰æ›´ã•ã‚ŒãŸã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’è‡ªå‹•çš„ã«ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã—ã¦ä¿å­˜

### incrementå‘½ä»¤

```rust
pub fn increment(ctx: Context<Increment>) -> Result<()> {
    let counter = &mut ctx.accounts.counter;
    counter.count += 1;
    Ok(())
}
```

**`has_one = authority`ã®å‹•ä½œ**:

```rust
#[derive(Accounts)]
pub struct Increment<'info> {
    #[account(
        mut,
        has_one = authority  // â† ã“ã‚Œ
    )]
    pub counter: Account<'info, Counter>,
    
    pub authority: Signer<'info>,
}
```

```
has_one = authority ãŒè¡Œã†æ¤œè¨¼:

1. counter.authority (Counteræ§‹é€ ä½“ã®authorityãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰)
2. authority.key() (Incrementæ§‹é€ ä½“ã®authorityã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ã‚­ãƒ¼)
3. ã“ã‚Œã‚‰ãŒä¸€è‡´ã™ã‚‹ã“ã¨ã‚’æ¤œè¨¼

ã¤ã¾ã‚Š:
ã€Œã“ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã«ç½²åã—ãŸäººãŒã€
 ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã®æ‰€æœ‰è€…(authority)ã¨åŒä¸€äººç‰©ã‹ï¼Ÿã€
ã‚’è‡ªå‹•ãƒã‚§ãƒƒã‚¯
```

---

## PDAï¼ˆProgram Derived Addressï¼‰

**PDA**ã¯ProgramãŒã€Œæ‰€æœ‰ã€ã§ãã‚‹ç‰¹æ®Šãªã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã™ã€‚

### ãªãœPDAãŒå¿…è¦ã‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é€šå¸¸ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ vs PDA                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  é€šå¸¸ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ:                                               â”‚
â”‚  - ç§˜å¯†éµã‹ã‚‰ç”Ÿæˆã•ã‚ŒãŸã‚¢ãƒ‰ãƒ¬ã‚¹                                   â”‚
â”‚  - ç½²åã«ã¯ç§˜å¯†éµãŒå¿…è¦                                          â”‚
â”‚  - å•é¡Œ: Programã¯ç§˜å¯†éµã‚’æŒã¦ãªã„ï¼                              â”‚
â”‚                                                                 â”‚
â”‚  PDA (Program Derived Address):                                 â”‚
â”‚  - Programã®ã‚¢ãƒ‰ãƒ¬ã‚¹ + ã‚·ãƒ¼ãƒ‰ã‹ã‚‰è¨ˆç®—ã§ç”Ÿæˆ                       â”‚
â”‚  - å¯¾å¿œã™ã‚‹ç§˜å¯†éµãŒã€Œå­˜åœ¨ã—ãªã„ã€ã‚ˆã†ã«è¨­è¨ˆ                        â”‚
â”‚  - ProgramãŒç›´æ¥ç½²åã§ãã‚‹ï¼ˆCPIã§ä½¿ç”¨ï¼‰                           â”‚
â”‚                                                                 â”‚
â”‚  ç”¨é€”:                                                           â”‚
â”‚  - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã®ãƒ‡ãƒ¼ã‚¿ä¿å­˜ï¼ˆã‚·ãƒ¼ãƒ‰ = ãƒ¦ãƒ¼ã‚¶ãƒ¼Pubkeyï¼‰            â”‚
â”‚  - ProgramãŒç®¡ç†ã™ã‚‹ãƒˆãƒ¼ã‚¯ãƒ³å£åº§                                  â”‚
â”‚  - æ±ºå®šçš„ãªã‚¢ãƒ‰ãƒ¬ã‚¹ç”Ÿæˆï¼ˆåŒã˜ã‚·ãƒ¼ãƒ‰ â†’ åŒã˜ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼‰              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### PDAã®å®Ÿè£…ä¾‹

```rust
#[derive(Accounts)]
pub struct CreateUserProfile<'info> {
    #[account(
        init,
        payer = user,
        space = 8 + UserProfile::INIT_SPACE,
        seeds = [b"user_profile", user.key().as_ref()],
        bump
    )]
    pub user_profile: Account<'info, UserProfile>,
    
    #[account(mut)]
    pub user: Signer<'info>,
    
    pub system_program: Program<'info, System>,
}

#[account]
#[derive(InitSpace)]
pub struct UserProfile {
    pub authority: Pubkey,    // 32
    #[max_len(50)]
    pub name: String,         // 4 + 50
    pub created_at: i64,      // 8
}
```

### `seeds`ã¨`bump`ã‚’ç†è§£ã™ã‚‹

```rust
seeds = [b"user_profile", user.key().as_ref()],
bump
```

**seedsã®è§£èª¬**:
```
seeds = [b"user_profile", user.key().as_ref()]
         â†“               â†“
         å›ºå®šæ–‡å­—åˆ—      ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å…¬é–‹éµ

ã‚¢ãƒ‰ãƒ¬ã‚¹è¨ˆç®—:
PDA = hash(seeds + program_id + bump)

ä¾‹:
- ãƒ¦ãƒ¼ã‚¶ãƒ¼A: seeds = ["user_profile", A_pubkey] â†’ PDA_A
- ãƒ¦ãƒ¼ã‚¶ãƒ¼B: seeds = ["user_profile", B_pubkey] â†’ PDA_B

åŒã˜ã‚·ãƒ¼ãƒ‰ã‹ã‚‰ã¯å¸¸ã«åŒã˜PDAãŒç”Ÿæˆã•ã‚Œã‚‹ï¼ˆæ±ºå®šçš„ï¼‰
```

**bumpã®è§£èª¬**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  bumpï¼ˆãƒãƒ³ãƒ—ã‚·ãƒ¼ãƒ‰ï¼‰ã¨ã¯                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  PDAã¯ã€Œæ¥•å††æ›²ç·šä¸Šã«ãªã„ç‚¹ã€ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„                    â”‚
â”‚  ï¼ˆç§˜å¯†éµãŒå­˜åœ¨ã—ãªã„ã“ã¨ã‚’ä¿è¨¼ã™ã‚‹ãŸã‚ï¼‰                         â”‚
â”‚                                                                 â”‚
â”‚  è¨ˆç®—æ–¹æ³•:                                                       â”‚
â”‚  1. bump = 255 ã‹ã‚‰é–‹å§‹                                          â”‚
â”‚  2. hash(seeds + program_id + bump) ã‚’è¨ˆç®—                       â”‚
â”‚  3. çµæœãŒæ›²ç·šä¸Šãªã‚‰ bump -= 1 ã—ã¦å†è¨ˆç®—                        â”‚
â”‚  4. æ›²ç·šä¸Šã«ãªã„ç‚¹ãŒè¦‹ã¤ã‹ã£ãŸã‚‰ãã‚ŒãŒPDA                         â”‚
â”‚                                                                 â”‚
â”‚  Anchorã®`bump`åˆ¶ç´„:                                             â”‚
â”‚  - åˆå›: bumpã‚’è‡ªå‹•è¨ˆç®—ã—ã¦ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ä¿å­˜                       â”‚
â”‚  - 2å›ç›®ä»¥é™: ä¿å­˜ã•ã‚ŒãŸbumpã‚’ä½¿ç”¨ï¼ˆè¨ˆç®—ã‚³ã‚¹ãƒˆå‰Šæ¸›ï¼‰              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### PDAã®ç‰¹å¾´ã¾ã¨ã‚

| ç‰¹å¾´ | èª¬æ˜ |
|-----|------|
| æ±ºå®šçš„ | åŒã˜ã‚·ãƒ¼ãƒ‰ã‹ã‚‰ã¯å¸¸ã«åŒã˜ã‚¢ãƒ‰ãƒ¬ã‚¹ |
| ç½²åä¸è¦ | ProgramãŒç›´æ¥æ“ä½œå¯èƒ½ï¼ˆCPIçµŒç”±ï¼‰ |
| ãƒ¦ãƒ‹ãƒ¼ã‚¯ | ã‚·ãƒ¼ãƒ‰ã®çµ„ã¿åˆã‚ã›ã§ä¸€æ„æ€§ã‚’ä¿è¨¼ |
| æ¤œè¨¼å¯èƒ½ | èª°ã§ã‚‚ã‚·ãƒ¼ãƒ‰ã‹ã‚‰ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å†è¨ˆç®—ã§ãã‚‹ |

---

## ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

```rust
use anchor_lang::prelude::*;

#[error_code]
pub enum ErrorCode {
    #[msg("Counter overflow")]
    Overflow,
    
    #[msg("Unauthorized access")]
    Unauthorized,
    
    #[msg("Invalid amount: must be greater than 0")]
    InvalidAmount,
}

#[program]
pub mod my_program {
    use super::*;

    pub fn increment(ctx: Context<Increment>, amount: u64) -> Result<()> {
        require!(amount > 0, ErrorCode::InvalidAmount);
        
        let counter = &mut ctx.accounts.counter;
        counter.count = counter.count
            .checked_add(amount)
            .ok_or(ErrorCode::Overflow)?;
        
        Ok(())
    }
}
```

### ã‚¨ãƒ©ãƒ¼å‡¦ç†ã®ãƒ‘ã‚¿ãƒ¼ãƒ³

```rust
// ãƒ‘ã‚¿ãƒ¼ãƒ³1: require!ãƒã‚¯ãƒ­
require!(amount > 0, ErrorCode::InvalidAmount);
// â†’ amountãŒ0ä»¥ä¸‹ãªã‚‰ã‚¨ãƒ©ãƒ¼ã‚’è¿”ã—ã¦çµ‚äº†

// ãƒ‘ã‚¿ãƒ¼ãƒ³2: checkedæ¼”ç®— + ok_or
counter.count
    .checked_add(amount)    // ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ãªã‚‰None
    .ok_or(ErrorCode::Overflow)?;  // Noneãªã‚‰ã‚¨ãƒ©ãƒ¼Return

// ãƒ‘ã‚¿ãƒ¼ãƒ³3: ifæ–‡ + return Err
if amount == 0 {
    return Err(ErrorCode::InvalidAmount.into());
}
```

---

## CPIï¼ˆCross-Program Invocationï¼‰

ã‚ã‚‹Programã‹ã‚‰åˆ¥ã®Programã‚’å‘¼ã³å‡ºã™æ©Ÿèƒ½ã§ã™ã€‚

```rust
use anchor_lang::prelude::*;
use anchor_spl::token::{self, Token, TokenAccount, Transfer};

pub fn transfer_tokens(ctx: Context<TransferTokens>, amount: u64) -> Result<()> {
    // CPIç”¨ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ§‹é€ ä½“ã‚’ä½œæˆ
    let cpi_accounts = Transfer {
        from: ctx.accounts.from.to_account_info(),
        to: ctx.accounts.to.to_account_info(),
        authority: ctx.accounts.authority.to_account_info(),
    };
    
    // å‘¼ã³å‡ºã™Programã‚’æŒ‡å®š
    let cpi_program = ctx.accounts.token_program.to_account_info();
    
    // CPIã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ä½œæˆ
    let cpi_ctx = CpiContext::new(cpi_program, cpi_accounts);
    
    // Token Programã®transferå‘½ä»¤ã‚’å‘¼ã³å‡ºã—
    token::transfer(cpi_ctx, amount)?;
    
    Ok(())
}

#[derive(Accounts)]
pub struct TransferTokens<'info> {
    #[account(mut)]
    pub from: Account<'info, TokenAccount>,
    #[account(mut)]
    pub to: Account<'info, TokenAccount>,
    pub authority: Signer<'info>,
    pub token_program: Program<'info, Token>,
}
```

### CPIã®æµã‚Œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CPIï¼ˆCross-Program Invocationï¼‰ã®ä»•çµ„ã¿                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ                                                    â”‚
â”‚      â”‚                                                          â”‚
â”‚      â–¼                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                             â”‚
â”‚  â”‚ ã‚ãªãŸã®Program â”‚                                             â”‚
â”‚  â”‚  (counter)     â”‚                                             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                             â”‚
â”‚          â”‚ CPI: token::transfer(...)                            â”‚
â”‚          â–¼                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                             â”‚
â”‚  â”‚ Token Program  â”‚  â† Solanaæ¨™æº–ã®ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†Program            â”‚
â”‚  â”‚  (SPL Token)   â”‚                                             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                             â”‚
â”‚                                                                 â”‚
â”‚  ç”¨é€”:                                                           â”‚
â”‚  - ãƒˆãƒ¼ã‚¯ãƒ³ã®è»¢é€/ãƒŸãƒ³ãƒˆ/ãƒãƒ¼ãƒ³                                   â”‚
â”‚  - ä»–ã®Programã®æ©Ÿèƒ½ã‚’å†åˆ©ç”¨                                     â”‚
â”‚  - ãƒ—ãƒ­ãƒˆã‚³ãƒ«é–“ã®é€£æºï¼ˆDeFiã§ã‚ˆãä½¿ã†ï¼‰                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## TypeScriptã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ

Anchorã¯è‡ªå‹•ã§TypeScriptã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ç”Ÿæˆã—ã¾ã™ã€‚

**tests/my_program.ts**:
```typescript
import * as anchor from "@coral-xyz/anchor";
import { Program } from "@coral-xyz/anchor";
import { MyProgram } from "../target/types/my_program";

describe("my_program", () => {
    // ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ï¼ˆæ¥ç¶š+ã‚¦ã‚©ãƒ¬ãƒƒãƒˆï¼‰ã‚’å–å¾—
    const provider = anchor.AnchorProvider.env();
    anchor.setProvider(provider);

    // Programã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’å–å¾—ï¼ˆIDLã‹ã‚‰è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸå‹ä»˜ãï¼‰
    const program = anchor.workspace.MyProgram as Program<MyProgram>;

    it("Initializes the counter", async () => {
        // æ–°ã—ã„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ã‚­ãƒ¼ãƒšã‚¢ã‚’ç”Ÿæˆ
        const counter = anchor.web3.Keypair.generate();
        
        // ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’é€ä¿¡
        await program.methods
            .initialize()          // å‘½ä»¤åï¼ˆRustã®é–¢æ•°åãŒã‚­ãƒ£ãƒ¡ãƒ«ã‚±ãƒ¼ã‚¹ã«ï¼‰
            .accounts({            // å¿…è¦ãªã‚¢ã‚«ã‚¦ãƒ³ãƒˆ
                counter: counter.publicKey,
                authority: provider.wallet.publicKey,
                systemProgram: anchor.web3.SystemProgram.programId,
            })
            .signers([counter])    // ç½²åè€…ï¼ˆæ–°è¦ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¯ç½²åãŒå¿…è¦ï¼‰
            .rpc();                // ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³é€ä¿¡

        // ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
        const account = await program.account.counter.fetch(counter.publicKey);
        console.log("Count:", account.count.toString());
    });
});
```

### IDLï¼ˆInterface Definition Languageï¼‰

`anchor build`ã™ã‚‹ã¨`target/idl/my_program.json`ãŒç”Ÿæˆã•ã‚Œã¾ã™ï¼š

```json
{
  "version": "0.1.0",
  "name": "my_program",
  "instructions": [
    {
      "name": "initialize",
      "accounts": [
        { "name": "counter", "isMut": true, "isSigner": true },
        { "name": "authority", "isMut": true, "isSigner": true },
        { "name": "systemProgram", "isMut": false, "isSigner": false }
      ],
      "args": []
    }
  ],
  "accounts": [
    {
      "name": "Counter",
      "type": {
        "kind": "struct",
        "fields": [
          { "name": "count", "type": "u64" },
          { "name": "authority", "type": "publicKey" }
        ]
      }
    }
  ]
}
```

ã“ã®IDLã‹ã‚‰TypeScriptã®å‹å®šç¾©ã‚‚è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ãŸã‚ã€**å‹å®‰å…¨ãªã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆé–‹ç™º**ãŒã§ãã¾ã™ã€‚

---

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

| ãƒªã‚¹ã‚¯ | å¯¾ç­– | Anchorã®æ”¯æ´ |
|-------|------|-------------|
| ç½²åè€…æ¤œè¨¼æ¼ã‚Œ | `Signer<'info>`ã‚’ä½¿ç”¨ | è‡ªå‹•æ¤œè¨¼ |
| æ‰€æœ‰è€…æ¤œè¨¼æ¼ã‚Œ | `Account<'info, T>`ãŒè‡ªå‹•æ¤œè¨¼ | discriminator + owner |
| ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ | `checked_add`, `checked_sub` | æ‰‹å‹•ã§å®Ÿè£… |
| å†å…¥æ”»æ’ƒ | - | Solanaã¯æ§‹é€ çš„ã«é˜²æ­¢ |
| PDAç½²åå½è£… | seeds/bumpã‚’æ¤œè¨¼ | è‡ªå‹•æ¤œè¨¼ |
| ä¸æ­£ãªã‚¢ã‚«ã‚¦ãƒ³ãƒˆå‹ | discriminatoræ¤œè¨¼ | è‡ªå‹•æ¤œè¨¼ |

### å®‰å…¨ãªã‚³ãƒ¼ãƒ‰ä¾‹

```rust
pub fn withdraw(ctx: Context<Withdraw>, amount: u64) -> Result<()> {
    let vault = &mut ctx.accounts.vault;
    
    // 1. å…¥åŠ›å€¤ã®æ¤œè¨¼
    require!(amount > 0, ErrorCode::InvalidAmount);
    
    // 2. æ®‹é«˜ãƒã‚§ãƒƒã‚¯ï¼ˆã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼é˜²æ­¢ï¼‰
    require!(vault.balance >= amount, ErrorCode::InsufficientFunds);
    
    // 3. checkedæ¼”ç®—ã§å®‰å…¨ã«æ¸›ç®—
    vault.balance = vault.balance
        .checked_sub(amount)
        .ok_or(ErrorCode::Overflow)?;
    
    // 4. è»¢é€å‡¦ç†...
    
    Ok(())
}
```

---

## é–‹ç™ºãƒ•ãƒ­ãƒ¼

```
1. anchor init project_name     # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
2. lib.rsã‚’ç·¨é›†                 # Programã‚’å®Ÿè£…
3. anchor build                 # ãƒ“ãƒ«ãƒ‰
4. anchor test                  # ãƒ†ã‚¹ãƒˆï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ï¼‰
5. anchor deploy --provider.cluster devnet  # Devnetã«ãƒ‡ãƒ—ãƒ­ã‚¤
6. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™º           # React + @coral-xyz/anchor
```

### Devnetã§ã®ãƒ†ã‚¹ãƒˆ

```bash
# Devnetã«åˆ‡ã‚Šæ›¿ãˆ
solana config set --url devnet

# ã‚¨ã‚¢ãƒ‰ãƒ­ãƒƒãƒ—ã§SOLã‚’å–å¾—ï¼ˆãƒ†ã‚¹ãƒˆç”¨ï¼‰
solana airdrop 2

# ãƒ‡ãƒ—ãƒ­ã‚¤
anchor deploy --provider.cluster devnet
```

---

## ã¾ã¨ã‚

| æ¦‚å¿µ | Ethereum/Solidity | Solana/Anchor |
|-----|------------------|---------------|
| ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆ | Contract | Program |
| ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ | Contractå†… | åˆ¥ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ |
| è¨€èª | Solidity | **Rust** |
| ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ | Hardhat/Foundry | Anchor |
| ã‚¢ãƒ‰ãƒ¬ã‚¹ç”Ÿæˆ | CREATE/CREATE2 | PDA |
| å¤–éƒ¨å‘¼ã³å‡ºã— | call/delegatecall | CPI |
| ã‚¬ã‚¹/æ‰‹æ•°æ–™ | é«˜ã„ | **éå¸¸ã«ä½ã„** |
| ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆ | ~15 TPS | **~65,000 TPS** |

ğŸ¯ **ã“ã®ç« ã®ãƒã‚¤ãƒ³ãƒˆ**:
- **`<'info>`** = ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å‡¦ç†ä¸­ã®ãƒ©ã‚¤ãƒ•ã‚¿ã‚¤ãƒ 
- **`#[account]`** = discriminator + ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º + æ‰€æœ‰è€…æ¤œè¨¼ã‚’è‡ªå‹•ç”Ÿæˆ
- **`#[derive(Accounts)]`** = ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ¤œè¨¼ã‚³ãƒ¼ãƒ‰ã‚’è‡ªå‹•ç”Ÿæˆ
- **PDA** = ProgramãŒæ‰€æœ‰ã§ãã‚‹ã€ã‚·ãƒ¼ãƒ‰ã‹ã‚‰æ±ºå®šçš„ã«ç”Ÿæˆã•ã‚Œã‚‹ã‚¢ãƒ‰ãƒ¬ã‚¹
- **Anchorãƒã‚¯ãƒ­** = 100è¡Œä»¥ä¸Šã®ãƒœã‚¤ãƒ©ãƒ¼ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’æ•°è¡Œã«åœ§ç¸®

---

## TypeScript/Pythonã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ãŸã‚ã®ç§»è¡Œã‚³ãƒ©ãƒ 

### Webé–‹ç™ºè€…ãŒSolanaé–‹ç™ºã§æˆ¸æƒ‘ã†ãƒã‚¤ãƒ³ãƒˆ

**1. ã€ŒçŠ¶æ…‹ãŒã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆå†…ã«ãªã„ã€**

```typescript
// Webé–‹ç™ºã®æ„Ÿè¦š
class UserService {
    private users: Map<string, User> = new Map();  // ã‚µãƒ¼ãƒ“ã‚¹å†…ã«çŠ¶æ…‹
    
    getUser(id: string) { return this.users.get(id); }
}

// Solanaã®æ„Ÿè¦š
// Program = ãƒ­ã‚¸ãƒƒã‚¯ã®ã¿
// çŠ¶æ…‹ = åˆ¥ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆå¤–éƒ¨ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã‚ˆã†ãªã‚‚ã®ï¼‰
```

**2. ã€Œã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ã‚’äº‹å‰ã«å®£è¨€ã€**

```typescript
// Webé–‹ç™º: é–¢æ•°å†…ã§è‡ªç”±ã«DBèª­ã¿æ›¸ã
async function updateUser(userId: string) {
    const user = await db.users.findById(userId);  // å‹•çš„ã«ã‚¢ã‚¯ã‚»ã‚¹
    user.name = "New Name";
    await user.save();
}

// Solana: ä½¿ã†ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’äº‹å‰ã«å®£è¨€
#[derive(Accounts)]
pub struct UpdateUser<'info> {
    #[account(mut)]
    pub user: Account<'info, User>,  // â† äº‹å‰ã«å®£è¨€å¿…é ˆ
}
```

**3. ã€Œãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ï¼é–¢æ•°å‘¼ã³å‡ºã—ã§ã¯ãªã„ã€**

```
Webé–‹ç™º:
ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ â†’ ã‚µãƒ¼ãƒãƒ¼ â†’ DB â†’ ãƒ¬ã‚¹ãƒãƒ³ã‚¹
(åŒæœŸçš„ã«çµæœãŒè¿”ã‚‹)

Solana:
ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ â†’ ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³é€ä¿¡ â†’ ãƒ–ãƒ­ãƒƒã‚¯ç¢ºå®šã‚’å¾…ã¤
(éåŒæœŸã€ç¢ºå®šã¾ã§æ•°ç§’ã‹ã‹ã‚‹å ´åˆã‚‚)
```

### Anchorãƒã‚¯ãƒ­ãŒéš ã—ã¦ã„ã‚‹ã‚‚ã®

```rust
// ã‚ãªãŸãŒæ›¸ãã‚³ãƒ¼ãƒ‰
#[account]
pub struct Counter {
    pub count: u64,
}

// AnchorãŒç”Ÿæˆã™ã‚‹ã‚³ãƒ¼ãƒ‰ï¼ˆæ¦‚ç•¥ï¼‰
impl Counter {
    pub const DISCRIMINATOR: [u8; 8] = [...];  // SHA256ãƒãƒƒã‚·ãƒ¥ã®å…ˆé ­8ãƒã‚¤ãƒˆ
}

impl AccountSerialize for Counter { ... }
impl AccountDeserialize for Counter { ... }
impl Owner for Counter {
    fn owner() -> Pubkey { crate::ID }  // ã“ã®ProgramãŒæ‰€æœ‰è€…
}
```

### ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ã¨å¯¾å‡¦æ³•

**ã‚¨ãƒ©ãƒ¼1: `AccountNotInitialized`**
```
åŸå› : å­˜åœ¨ã—ãªã„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’èª­ã‚‚ã†ã¨ã—ãŸ
å¯¾å‡¦: initã§åˆæœŸåŒ–ã™ã‚‹ã‹ã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒå­˜åœ¨ã™ã‚‹ã“ã¨ã‚’ç¢ºèª
```

**ã‚¨ãƒ©ãƒ¼2: `ConstraintHasOne`**
```
åŸå› : has_oneåˆ¶ç´„ã®æ¤œè¨¼ã«å¤±æ•—
å¯¾å‡¦: ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å€¤ã¨æ¸¡ã—ãŸã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒä¸€è‡´ã—ã¦ã„ã‚‹ã‹ç¢ºèª
```

**ã‚¨ãƒ©ãƒ¼3: `AccountDiscriminatorMismatch`**
```
åŸå› : ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®å‹ãŒæœŸå¾…ã¨ç•°ãªã‚‹
å¯¾å‡¦: æ­£ã—ã„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æ¸¡ã—ã¦ã„ã‚‹ã‹ç¢ºèª
```

---

## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

Solana/Anchoré–‹ç™ºã‚’æ·±ã‚ã‚‹ãŸã‚ã®ãƒªã‚½ãƒ¼ã‚¹ï¼š

| ãƒªã‚½ãƒ¼ã‚¹ | èª¬æ˜ |
|---------|------|
| [Anchor Book](https://book.anchor-lang.com/) | å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ |
| [Solana Cookbook](https://solanacookbook.com/) | ãƒ¬ã‚·ãƒ”é›† |
| [Solana Playground](https://beta.solpg.io/) | ãƒ–ãƒ©ã‚¦ã‚¶IDE |
| [Buildspace](https://buildspace.so/) | ãƒãƒ³ã‚ºã‚ªãƒ³ã‚³ãƒ¼ã‚¹ |
| [Solana Stack Exchange](https://solana.stackexchange.com/) | Q&A |

---

## ãŠã‚ã‚Šã«

ã“ã®æ•™æã§ã¯ã€Python/TypeScriptã®çŸ¥è­˜ã‚’ãƒ™ãƒ¼ã‚¹ã«ã€Rustã®åŸºç¤ã‹ã‚‰Webé–‹ç™ºã€ãã—ã¦Solana/Anchorã«ã‚ˆã‚‹ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³é–‹ç™ºã¾ã§å­¦ã³ã¾ã—ãŸã€‚

### å­¦ç¿’ã®æŒ¯ã‚Šè¿”ã‚Š

| Part | å†…å®¹ | èº«ã«ã¤ã„ãŸã‚¹ã‚­ãƒ« |
|-----|------|----------------|
| åŸºç¤ï¼ˆCh.0-4ï¼‰ | å‹ã€æ‰€æœ‰æ¨©ã€ã‚¨ãƒ©ãƒ¼å‡¦ç† | Rustã‚³ãƒ¼ãƒ‰ã®èª­ã¿æ›¸ã |
| ä¸­ç´šï¼ˆCh.5-8ï¼‰ | ãƒˆãƒ¬ã‚¤ãƒˆã€éåŒæœŸã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« | ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æ´»ç”¨ |
| å¿œç”¨ï¼ˆCh.9-10ï¼‰ | Web APIã€ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆ | å®Ÿè·µçš„ãªé–‹ç™º |

### Rust Ã— Solanaã§å­¦ã‚“ã ã“ã¨

- **æ‰€æœ‰æ¨©** â†’ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®æ‰€æœ‰è€…æ¤œè¨¼ã«ç›´çµ
- **ãƒ©ã‚¤ãƒ•ã‚¿ã‚¤ãƒ `'a`** â†’ `<'info>`ã®ç†è§£ã«å¿…é ˆ
- **ãƒˆãƒ¬ã‚¤ãƒˆ** â†’ Anchorã®Accountã€Signerç­‰ã®å‹åˆ¶ç´„
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°** â†’ Resultå‹ã€`?`æ¼”ç®—å­
- **ãƒã‚¯ãƒ­** â†’ Anchorã®`#[account]`ã€`#[program]`

### æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

1. **Solana Playgroundã§å®Ÿé¨“** â€” ãƒ–ãƒ©ã‚¦ã‚¶ã§æ°—è»½ã«è©¦ã™
2. **ã‚·ãƒ³ãƒ—ãƒ«ãªDAppã‚’ä½œã‚‹** â€” Counter â†’ Todo â†’ NFT
3. **æ—¢å­˜ã®Protocolã‚’èª­ã‚€** â€” Jupiterã€Marinadeç­‰ã®OSS
4. **Anchor Discordã«å‚åŠ ** â€” ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã§è³ªå•ãƒ»å­¦ç¿’

**Happy Building on Solana! ğŸ¦€âš¡**
